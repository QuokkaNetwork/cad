# Server
PORT=3030
NODE_ENV=development
JWT_SECRET=change-me-to-a-random-string

# Steam OpenID
STEAM_API_KEY=your-steam-api-key
STEAM_REALM=http://localhost:3030
STEAM_RETURN_URL=http://localhost:3030/api/auth/steam/callback

# Auth cookie
AUTH_COOKIE_NAME=cad_token
AUTH_COOKIE_SAMESITE=Lax
# Set true only when using HTTPS
AUTH_COOKIE_SECURE=false
# Optional cookie domain (blank = current host)
AUTH_COOKIE_DOMAIN=

# Discord Bot
DISCORD_BOT_TOKEN=your-discord-bot-token
DISCORD_GUILD_ID=your-guild-id
DISCORD_CLIENT_ID=your-discord-client-id
DISCORD_CLIENT_SECRET=your-discord-client-secret
DISCORD_PERIODIC_SYNC_MINUTES=10

# Auto Update (VPS)
AUTO_UPDATE_ENABLED=false
AUTO_UPDATE_INTERVAL_MINUTES=5
AUTO_UPDATE_BRANCH=main
# Force updater to discard local repo changes before checking/applying updates.
AUTO_UPDATE_FORCE_SYNC=true
# Comma-separated paths to preserve when cleaning untracked files.
# Keep .env and server data by default.
AUTO_UPDATE_PRESERVE_PATHS=.env,server/data/
# Optional on Windows VPS if git is not in PATH:
# GIT_BIN=C:\Program Files\Git\cmd\git.exe
# Optional on Windows VPS if npm is not in PATH:
# NPM_BIN=C:\Program Files\nodejs\npm.cmd
AUTO_UPDATE_RUN_NPM_INSTALL=true
AUTO_UPDATE_RUN_WEB_BUILD=true
AUTO_UPDATE_EXIT_ON_UPDATE=true
AUTO_UPDATE_SELF_RESTART=true

# Optional fallback for FiveM bridge auth token (Admin setting overrides this)
# FIVEM_BRIDGE_SHARED_TOKEN=change-me-long-random-token

# QBox MySQL (optional - can be configured via admin panel)
QBOX_DB_HOST=127.0.0.1
QBOX_DB_PORT=3306
QBOX_DB_USER=root
QBOX_DB_PASSWORD=
QBOX_DB_NAME=qbox

# Frontend URL (for CORS and redirects)
# In production this should be your public CAD URL (same base as STEAM_REALM), not :5173.
WEB_URL=http://localhost:3030
# Example production values behind nginx + certbot:
# WEB_URL=https://cad.quokkanetworks.net
# STEAM_REALM=https://cad.quokkanetworks.net
# STEAM_RETURN_URL=https://cad.quokkanetworks.net/api/auth/steam/callback
# AUTH_COOKIE_SECURE=true

# Radio behavior mode:
# - sonoran = default; native FiveM/pma-voice path (no CAD legacy bridge)
# - legacy  = optional CAD websocket + mumble bridge path
RADIO_BEHAVIOR=sonoran
VOICE_BRIDGE_ENABLED=false
# Set true only when using RADIO_BEHAVIOR=legacy and CAD voice bridge features.

# Legacy Mumble bridge settings (optional; only for RADIO_BEHAVIOR=legacy)
# MUMBLE_MANAGE=true  -> CAD may spawn rust-mumble.exe from server/murmur/
# MUMBLE_HOST/MUMBLE_PORT -> host/port CAD bridge connects to
# MUMBLE_PUBLIC_IP    -> optional public IP hint for legacy setups
MUMBLE_HOST=127.0.0.1
MUMBLE_PORT=64738
MUMBLE_PUBLIC_IP=
MUMBLE_PASSWORD=
# Optional comma-separated ACL tokens
MUMBLE_TOKENS=
MUMBLE_REJECT_UNAUTHORIZED=false
# Default false so dispatcher bridge can use normal UDP CryptSetup flow.
# Set true only as a fallback if CAD connects to a non-local Mumble host.
# (localhost/127.0.0.1 always uses UDP to avoid CryptSetup reset loops)
MUMBLE_DISABLE_UDP=false
MUMBLE_DISPATCHER_NAME_PREFIX=CAD_Dispatcher

# FiveM server path (optional; used for cad_bridge resource auto-sync only)
# Set this to the folder that contains your FiveM server.cfg.
# Example (Windows): FIVEM_SERVER_PATH=C:\FXServer\server-data
# Example (Linux):   FIVEM_SERVER_PATH=/home/fivem/server-data
FIVEM_SERVER_PATH=

# HTTP / reverse-proxy handling:
# - false: direct connection (no proxy)
# - true/1: trust first proxy hop
# - N: trust N proxy hops
TRUST_PROXY=false
# For nginx reverse proxy in production use:
# TRUST_PROXY=1

# API rate limiting
# Set *_MAX to 0 to disable that limiter.
API_RATE_LIMIT_WINDOW_MS=900000
API_RATE_LIMIT_MAX=500
API_RATE_LIMIT_SKIP_AUTHENTICATED=true
FIVEM_RATE_LIMIT_WINDOW_MS=900000
FIVEM_RATE_LIMIT_MAX=120000

# Live map now uses cad_bridge heartbeat data directly inside CAD (Snaily-style mapping).

# QBox custom field mappings (optional JSON arrays; can also be set in Admin > System Settings)
# QBOX_PERSON_CUSTOM_FIELDS=[{"key":"job","source":"charinfo","path":"job.label"}]
# QBOX_VEHICLE_CUSTOM_FIELDS=[{"key":"mods_class","source":"column","column":"mods","path":"class"}]
