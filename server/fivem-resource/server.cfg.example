# =============================================================================
# CAD Bridge Voice Configuration
# =============================================================================
# Add these lines to your FiveM server.cfg.
#
# SETUP OVERVIEW (everything on one Windows VPS):
#
#   rust-mumble.exe  <-- managed by CAD (starts automatically, no manual setup)
#       |
#       +-- 127.0.0.1:64738  <-- CAD voice bridge (mumble-node) connects here
#       |
#       +-- 0.0.0.0:64738    <-- FiveM in-game players connect here
#                                via voice_externalAddress in server.cfg
#
# The CAD auto-starts rust-mumble.exe from server/murmur/rust-mumble.exe when
# MUMBLE_MANAGE=true is set in .env. Port 64738 TCP+UDP must be open
# in Windows Firewall and your VPS provider's security group.
#
# TIP: Set FIVEM_SERVER_PATH in .env to have the CAD automatically write
# voice.cfg to your FiveM server folder and keep it up to date on restart.
# =============================================================================
# STEP 1: Open port 64738 in Windows Firewall (run in PowerShell as Admin):
#
#   netsh advfirewall firewall add rule name="Mumble Voice" protocol=TCP dir=in localport=64738 action=allow
#   netsh advfirewall firewall add rule name="Mumble Voice UDP" protocol=UDP dir=in localport=64738 action=allow
#
# Also open port 64738 in your VPS provider's security group / network firewall.
# =============================================================================

# =============================================================================
# STEP 2: Configure FiveM voice to use the managed Mumble server
# =============================================================================
# Replace 103.203.241.35 with your VPS public IP.
# voice_externalPort must match MUMBLE_PORT in your CAD .env (default 64738).

setr voice_externalAddress "103.203.241.35"
setr voice_externalPort 64738
setr voice_allowSetIntent 1
setr voice_hideEndpoints 1

# Required for radio filter/submix audio.
setr voice_useNativeAudio true
setr voice_enableSubmix 1
setr voice_defaultRadioVolume 100
# cad_bridge handles radio routing and keybinds.
setr voice_enableRadios 0

# =============================================================================
# STEP 3: Configure the CAD bridge resource
# =============================================================================

set cad_bridge_base_url "http://127.0.0.1:3031"
set cad_bridge_token "Ku3xaT6MVe+GgGC9qQu2bMbdqBEPY7cXCyRd3WISCjA="

# NPWD 000 emergency number interception
set cad_bridge_npwd_emergency_numbers "000"
set cad_bridge_npwd_resource "npwd"

# Fine + job sync
set cad_bridge_fine_adapter "auto"
set cad_bridge_job_sync_adapter "auto"

# Radio adapter for CAD-driven radio channel join/leave events:
# 'cad-radio' -> CAD custom radio (recommended/default)
# 'none'      -> disable in-game radio sync
set cad_bridge_radio_adapter "cad-radio"
set cad_bridge_radio_ui_enabled "true"
set cad_bridge_radio_ui_key "EQUALS"
set cad_bridge_radio_ptt_key "LMENU"
set cad_bridge_radio_follow_native_ptt "true"
set cad_bridge_radio_max_frequency "500"

# Driver license + registration commands/forms
set cad_bridge_license_command "cadlicense"
set cad_bridge_registration_command "cadrego"
set cad_bridge_show_id_command "showid"
set cad_bridge_show_id_target_distance "4.0"
set cad_bridge_license_default_expiry_days "35"
set cad_bridge_registration_default_days "35"
set cad_bridge_document_fee_account "bank"
# Photo capture provider:
# screenshot-basic (recommended), mugshotbase64, or auto
set cad_bridge_mugshot_provider "screenshot-basic"
set cad_bridge_screenshot_resource "screenshot-basic"
set cad_bridge_screenshot_encoding "png"
set cad_bridge_screenshot_quality "1.0"
set cad_bridge_screenshot_timeout_ms "5000"
# Legacy fallback resource (optional)
set cad_bridge_mugshot_resource "MugShotBase64"

# =============================================================================
# STEP 4: Ensure the resource starts
# =============================================================================

ensure screenshot-basic
ensure cad_bridge
